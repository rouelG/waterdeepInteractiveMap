<!DOCTYPE html>
<html>
<head>
  <title>Fantasy Map</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet-search@3.0.2/dist/leaflet-search.min.css" />

  <style>
    #map {
       height: 100vh;
	  width: 100vw;
    }
  </style>
</head>
<body>
  <div id="map"></div>
 <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-search@3.0.2/dist/leaflet-search.min.js"></script>
  <script>
    var myMap = L.map('map', {
      crs: L.CRS.Simple,
      minZoom: -5,
      maxZoom: 3,
      zoomSnap: 0.5,
      zoomDelta: 0.5,
      wheelPxPerZoomLevel: 80
    });

    var imageBounds = [[0,0], [7256,3560]];
    var imageUrl = 'https://www.aidedd.org/atlas/images/waterdeep-3560-7256.jpg';
    var fantasyMap = L.imageOverlay(imageUrl, imageBounds);

    fantasyMap.addTo(myMap);
    myMap.fitBounds(imageBounds);
	
	var default_icon_size = [16, 16]
	var default_icon_anchor = [(default_icon_size[0]+1)/2, (default_icon_size[1]+1)/2]

var houseMarker = L.icon({
      iconUrl: 'https://www.pinclipart.com/picdir/big/564-5647199_transparent-home-icon-clipart-circle-transparent-home-icon.png',
      iconSize: default_icon_size,
      iconAnchor: default_icon_anchor
    });

var templeMarker = L.icon({
      iconUrl: 'https://www.tasteofthailand.org/wp-content/uploads/2020/08/temple-2.png',
      iconSize: default_icon_size,
      iconAnchor: default_icon_anchor
    });
	
var tavernMarker = L.icon({
      iconUrl: 'https://coffeewebdesign.com/wp-content/uploads/2014/10/logo-coffee.png',
      iconSize: [16, 16],
      iconAnchor: [8, 8]
    });

var factionMarker = L.icon({
      iconUrl: 'https://cdn3.iconfinder.com/data/icons/animals-1-1/512/22-512.png',
      iconSize: [16, 16],
      iconAnchor: [8, 8]
    });

	var markersLayer = new L.LayerGroup();
	myMap.addLayer(markersLayer);

	var data = [
	{"loc": [3690,2740], "title": "Lorian's Treehouse","popup": '<p><a href = https://www.notion.so/Lorian-s-Treehouse-a3f753300f5d40fca0a093310cec8bcd?pvs=4"target="_blank">Lorians ancient home</a> in Waterdeep</p>',"icon": houseMarker},
	{"loc": [2785,2055], "title": "Yawning Portal","popup": '<p><a href =https://www.notion.so/Yawning-Portal-33767857019041b9aa6cac6b127100aa "target="_blank">Durnans inn</a> that is one of the most popular in the city</p>',"icon": tavernMarker},
	{"loc": [2230,2455], "title": "Zhentarim Warehouse","popup": '<p><a href =https://www.notion.so/Zhentarim-warehouse-866d8a7d7ef9485596b1347bd974f4f6?pvs=4 "target="_blank">A Zhentarim faction</a> in Candle Lane</p>',"icon": factionMarker},
	{"loc": [2205,2470	], "title": "Thirsty Throat","popup": '<p><a href =https://www.notion.so/Thirsty-Throat-9c17249e54344e09aadbd14efd961ae0 "target="_blank">A gentlemens club</a> in Candle Lane</p>',"icon": tavernMarker},
	{"loc": [2430,790], "title": "Hall of Broken Mirrors","popup": '<p> Previously the <a href="https://www.notion.so/Hall-of-light-Mirrors-b5f5a0549d964fa3ad57b9420c4a095b?pvs=4"target="_blank"> Hall of Light Mirrors</a> <br /> <a href="https://www.notion.so/Hall-of-Broken-Mirrors-de481b350be54e0aa016aca373cf8ea0?pvs=4"target="_blank"> The home temple </a> of Lumi√®re in Castle ward.</p>',"icon":templeMarker},	
	{"loc": [2175,2935], "title": "Rosie's home","popup": '<p><a href = https://www.notion.so/Dirk-and-Rosie-s-House-1bfb5ec3ad1845a88799f6519619c8d5?pvs=4"target="_blank">House of Rosie and Dirk</a> in Waterdeep</p>',"icon": houseMarker}
	];
	
	
	
	for (i in data){
		var title = data[i].title;
		var loc = data[i].loc;
		var popup = data[i].popup;
		var icon = data[i].icon;
		var marker = new L.marker(new L.latLng(loc), {title: title,icon:icon}); 
		marker.bindPopup(title + '<br />' +popup);
		markersLayer.addLayer(marker);
    };
	
	
	var searchControl = new L.Control.Search({
    layer: markersLayer,
    marker: false,
    textPlaceholder: 'Search for a marker'
    });
	myMap.addControl(searchControl);
	searchControl.on('search:locationfound', function(e) {
        e.layer.openPopup();
		});
    
	
	myMap.setZoom(myMap.options.minZoom);
	myMap.on('zoomend', function() {
		
		var currentZoom = myMap.getZoom();

		var factor = (currentZoom - myMap.options.minZoom)*0.5 + 1
		
		markersLayer.eachLayer(function(layer) {
			var iconOptions = layer.options.icon.options;
			var newIcon = L.icon({
				iconUrl: iconOptions.iconUrl,
				iconSize: [default_icon_size[0]*factor,default_icon_size[1]*factor],
				iconAnchor: [default_icon_anchor[0]*factor,default_icon_anchor[1]*factor]
			});
			layer.setIcon(newIcon);
		});
	}); 
	
  </script>
</body>
</html>
